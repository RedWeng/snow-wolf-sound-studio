# 雪狼錄音派對 2026 Q2 系統更新

## 📅 更新日期
2026-02-03

## 🎯 更新內容

### 1. 場次資料更新（7場）

#### ① 4/12（日）- 雪狼經典場 × 擬音錄音
- **類型**: 家庭場
- **地點**: 玉成錄音室
- **時間**: 13:00-16:00 (180分鐘)
- **價格**: $5,500（固定家庭價，2-5人）
- **容量**: 15組家庭
- **特色**: 金鐘獎得主吳培倫老師帶領

#### ② 4/19（日）- 雪狼雙語全日場（已包場）
- **狀態**: 不開放報名（status: 'cancelled'）
- **顯示**: 灰色顯示「已包場」標籤
- **價格**: $60,000（包場價）

#### ③ 4/26（日）- 慢慢先生的一天
- **類型**: 小小孩劇場
- **地點**: DD BOX（台北兒童新樂園內2F劇場）
- **時間**: 13:00-15:40 (160分鐘)
- **價格**: $2,800/位
- **容量**: 20位
- **年齡**: 5-7歲
- **老師**: 昱佳老師

#### ④ 5/17（日）- 時空 MV 場＋機器人 LIVE 錄音
- **類型**: 家庭場
- **地點**: 玉成錄音室
- **時間**: 13:00-15:00 (120分鐘)
- **價格**: $5,500（固定家庭價）
- **容量**: 15組家庭

#### ⑤ 5/24（日）- 世界沒有對齊
- **類型**: 小小孩劇場
- **地點**: DD BOX
- **時間**: 13:00-15:40 (160分鐘)
- **價格**: $2,800/位
- **容量**: 20位
- **年齡**: 5-7歲
- **老師**: 筱茵老師

#### ⑥ 6/14（日）- 雪狼男孩《卡達爾之戰》動畫場
- **類型**: 大孩子動畫場
- **地點**: DD BOX 135劇場
- **時間**: 13:00-15:45 (165分鐘)
- **價格**: $3,600/位
- **容量**: 20位
- **年齡**: 8-13歲
- **老師**: 昀晴老師（建議）

#### ⑦ 6/28（日）- RPG《穆高爾傳說》遊戲廣告錄音
- **類型**: 家庭場
- **地點**: 玉成錄音室
- **時間**: 13:00-15:10 (130分鐘)
- **價格**: $5,500（固定家庭價）
- **容量**: 15組家庭
- **年齡**: 8-13歲適合
- **老師**: 一帆老師（建議）

---

### 2. 定價系統

#### 票價設定
- 🎭 **小小孩劇場**: $2,800/位
- 🧠 **大孩子動畫場**: $3,600/位
- 🤖 **家庭場**: $5,500/家庭（固定價，2-5人）

#### 家庭場規則
- 固定價格 $5,500
- 不論2-5人，價格相同
- 以「家庭」為單位，不拆人頭計算
- 回饋也以「家庭」為單位

---

### 3. 回饋機制（同一筆訂單內）

#### 折扣規則
```
2場/2人以上 → 每項目 -$300
3場/3人以上 → 每項目 -$400（上限）
```

#### 適用範圍
- ✅ 場次票價
- ✅ 家庭場
- ✅ 加購項目

#### 重要規則
- ⚠️ 僅限「同一筆訂單內」計算
- ⚠️ 不做跨訂單累積
- ⚠️ 每項目最高回饋 -$400
- ⚠️ 回饋擇一，不疊加

#### 案例說明
```
✅ 案例1: 2個孩子同場
   → 算「兩人以上」→ 每位 -$300

✅ 案例2: 1個家庭報名2場
   → 算「兩場以上」→ 每場 -$300

✅ 案例3: 家庭場 $5,500 + 加購 $4,500
   → 家庭場最多 -$400
   → 加購最多 -$400
   → 總折扣 $800

❌ 案例4: 分兩筆訂單
   → 不觸發回饋
```

---

### 4. 加購設定

#### 動畫錄音完成品
- **項目**: 專業錄製的動畫配音完成品
- **價格**: $4,500/組
- **時間**: 30分鐘
- **名額**: 每場限4組
- **適用**: 所有場次皆可加購
- **回饋**: 適用折扣（最高-$400）

---

### 5. 解鎖獎勵（遊戲化顯示）

#### 小小孩劇場
- 15位 → 🍪 小點心
- 18位 → 🎁 小禮物

#### 大孩子動畫場
- 14位 → 🎁 小禮物
- 18位 → ✨ 升級版

#### 家庭場
- 10組 → 🎁 小禮物
- 12組 → ✨ 升級版

**顯示方式**: 
- 不顯示具體人數
- 只顯示已解鎖/即將解鎖狀態
- 遊戲化進度條
- 不影響結帳邏輯

---

### 6. 包場設定

- **價格**: $60,000起
- **內容**: 使用既有雪狼內容
- **不含**: 客製腳本
- **回饋**: 不適用公開場回饋

---

## 🔧 技術實作

### 新增檔案

1. **lib/api/discount-calculator.ts**
   - 折扣計算引擎
   - 支持個人票、家庭場、加購
   - 自動計算折扣層級

2. **lib/config/addons.ts**
   - 加購項目配置
   - 動畫錄音完成品定義

3. **lib/config/unlock-rewards.ts**
   - 解鎖獎勵配置
   - 遊戲化進度計算
   - 支持三種場次類型

### 更新檔案

1. **lib/mock-data/sessions.ts**
   - 完整更新7場次資料
   - 移除舊場次

2. **lib/types/database.ts**
   - 新增 `Addon` 介面
   - `OrderItem` 新增 `discount_amount` 和 `is_addon` 欄位

3. **lib/context/CartContext.tsx**
   - 整合新的折扣計算引擎
   - 支持家庭場和加購
   - 新增 `getDiscountTier()` 方法

4. **lib/api/orders.ts**
   - 更新 `createOrderItems` 支持折扣金額

5. **lib/mock-data/orders.ts**
   - 所有訂單項目新增 `discount_amount`

---

## ✅ 編譯狀態

```bash
✓ Compiled successfully
✓ Finished TypeScript
✓ All diagnostics passed
```

---

## 📝 待實作項目

### 前端UI更新
1. **Sessions頁面**
   - [ ] 顯示新的7場次
   - [ ] 家庭場選擇UI（不選孩子，選家庭）
   - [ ] 加購選項UI
   - [ ] 解鎖獎勵顯示（遊戲化）
   - [ ] 4/19包場灰色顯示

2. **購物車**
   - [ ] 顯示折扣層級提示
   - [ ] 顯示每項目折扣金額
   - [ ] 加購項目顯示
   - [ ] 折扣說明文字

3. **結帳頁面**
   - [ ] 折扣明細顯示
   - [ ] 家庭場資訊顯示
   - [ ] 加購項目確認

### 後端邏輯
1. **訂單創建**
   - [ ] 整合折扣計算
   - [ ] 驗證加購名額（每場限4組）
   - [ ] 家庭場驗證（2-5人）

2. **Email通知**
   - [ ] 訂單確認信包含折扣資訊
   - [ ] 加購項目資訊

---

## 🎮 使用者體驗重點

1. **清楚的定價**
   - 家庭場固定價 $5,500
   - 不用計算人頭

2. **透明的折扣**
   - 即時顯示折扣層級
   - 清楚說明如何獲得更多折扣

3. **遊戲化獎勵**
   - 不顯示具體人數（避免壓力）
   - 只顯示解鎖狀態（增加期待）

4. **簡單的加購**
   - 一鍵加購
   - 清楚顯示名額限制

---

## 🚀 下一步

1. 更新Sessions頁面UI
2. 更新CartSidebar顯示折扣
3. 更新Checkout頁面
4. 測試完整報名流程
5. 測試折扣計算正確性

---

**更新完成時間**: 2026-02-03
**系統狀態**: ✅ 編譯成功，後端邏輯完成
**待完成**: 前端UI更新
